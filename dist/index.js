'use strict';var s=require('@actions/core'),d=require('@actions/github'),e=require('fs/promises'),i=require('path'),glob=require('glob'),exec=require('@actions/exec');function _interopNamespace(e){if(e&&e.__esModule)return e;var n=Object.create(null);if(e){Object.keys(e).forEach(function(k){if(k!=='default'){var d=Object.getOwnPropertyDescriptor(e,k);Object.defineProperty(n,k,d.get?d:{enumerable:true,get:function(){return e[k]}});}})}n.default=e;return Object.freeze(n)}var s__namespace=/*#__PURE__*/_interopNamespace(s);var d__namespace=/*#__PURE__*/_interopNamespace(d);var e__namespace=/*#__PURE__*/_interopNamespace(e);var i__namespace=/*#__PURE__*/_interopNamespace(i);async function l(){try{let t=s__namespace.getInput("docs-folder",{required:!0}),o=s__namespace.getInput("github-token",{required:!0}),c=d__namespace.context,g=`https://x-access-token:${o}@github.com/${c.repo.owner}/${c.repo.repo}.wiki.git`;await r("git",["clone",g,"wiki-repo"]);let p=await glob.glob(`${t}/**/*.md`),w=await glob.glob(`${t}/**/*.{png,jpg,jpeg,gif,svg}`);for(let a of w){let m=i__namespace.relative(t,a),n=i__namespace.join("wiki-repo",m);await e__namespace.mkdir(i__namespace.dirname(n),{recursive:!0}),await e__namespace.copyFile(a,n);}for(let a of p){let m=i__namespace.relative(t,a),n=i__namespace.join("wiki-repo",m),u=await e__namespace.readFile(a,"utf8");u=k(u,i__namespace.dirname(m)),await e__namespace.mkdir(i__namespace.dirname(n),{recursive:!0}),await e__namespace.writeFile(n,u);}await r("git",["-C","wiki-repo","add","."]),await r("git",["-C","wiki-repo","config","user.name","GitHub Action"]),await r("git",["-C","wiki-repo","config","user.email","action@github.com"]),await r("git",["-C","wiki-repo","commit","-m","Update wiki content"]),await r("git",["-C","wiki-repo","push"]);}catch(t){t instanceof Error&&s__namespace.setFailed(t.message);}}function k(t,o){return t.replace(/!\[(.*?)\]\((.*?)\)/g,(c,g,p)=>{if(p.startsWith("http"))return c;let w=i__namespace.join(o,p);return `![${g}](${w})`})}async function r(t,o){await exec.exec(t,o);}l();
exports.updateImageLinks=k;//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map